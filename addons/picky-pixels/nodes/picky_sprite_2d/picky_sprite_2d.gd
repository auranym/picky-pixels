@tool
class_name PickySprite2D
extends Sprite2D

@onready var _material: ShaderMaterial = material

var _data: PickySprite2DData
## Data used for rendering a PickySprite2D.
## This Resource includes the encoded texture,
## decoding shader, and other data used for compatility.
## This Resource is generated by the PickyPixels editor.
@export var data: PickySprite2DData:
	get: return _data
	set(d):
		if not is_inside_tree():
			await ready
		_data = d
		
		if _data == null or _data.texture == null:
			texture = null
			return
		
		# TODO also check if there is not the correct shader on the viewport
		if Engine.is_editor_hint():
			texture = _data.base_textures.back()
			material = null
		else:
			texture = _data.texture
			material = _material


func _ready():
	print(str(Color(0, 0, 0)))
